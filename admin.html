<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Panel Administrador</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <link rel="stylesheet" href="style.css">

  <style>
    body {
  margin: 0;
  font-family: Arial, sans-serif;
  overflow-x: hidden;
}

    /* ===== HEADER ===== */
    .topbar {
      height: 60px;
      background: #020617;
      display: flex;
      align-items: center;
      padding: 0 20px;
      border-bottom: 1px solid #1e293b;
    }

    .menu-btn {
      font-size: 22px;
      cursor: pointer;
      background: none;
      border: none;
      color: #f8fafc;
    }

    .title {
      margin-left: 15px;
      font-weight: 600;
    }

    /* ===== SIDEBAR ===== */
    .sidebar {
      position: fixed;
      top: 0;
      left: -260px;
      width: 260px;
      height: 100%;
      background: #020617;
      border-right: 1px solid #1e293b;
      transition: left 0.3s ease;
      padding-top: 60px;
      z-index: 1000;
    }

    .sidebar.active {
      left: 0;
    }

    .sidebar ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .sidebar li {
      padding: 15px 20px;
      cursor: pointer;
      border-bottom: 1px solid #1e293b;
      transition: background 0.2s;
    }

    .sidebar li:hover {
      background: #1e293b;
    }

    .sidebar li span {
      margin-right: 10px;
    }

    /* ===== CONTENT ===== */
    .content {
      padding: 30px;
      transition: margin-left 0.3s ease;
    }

    .content.shift {
      margin-left: 260px;
    }
  </style>
</head>

<body>

  <div class="topbar">
    <button class="menu-btn" id="menuBtn">‚ò∞</button>
    <div class="title">Panel Administrador</div>
  </div>

  <div class="sidebar" id="sidebar">
    <ul>
      <li data-section="dashboard"><span>üìä</span>Dashboard</li>
      <li data-section="alta"><span>‚ûï</span>Alta de closers</li>
      <li data-section="baja"><span>‚ûñ</span>Baja de closers</li>
      <li data-section="closers"><span>üë§</span>Closers</li>
      <li data-section="ventas"><span>üí∞</span>Ventas</li>
      <li data-section="pagos"><span>üßæ</span>Pago mensual closers</li>
      <li data-section="historico"><span>üìÅ</span>Historico total</li>
      <li data-section="idioma"><span>üåç</span>Idioma</li>
      <li id="logoutBtn"><span>üö™</span>Logout</li>
    </ul>
  </div>

  <div class="content" id="contentArea">

  <!-- CONTENEDOR DIN√ÅMICO -->
  <div id="adminSection"></div>

</div>

<script src="auth.js"></script>

<script>
  const menuBtn = document.getElementById("menuBtn");
  const sidebar = document.getElementById("sidebar");
  const content = document.getElementById("contentArea");
  
  const adminSection = document.getElementById("adminSection");

async function loadSection(section) {

  if (section === "dashboard") {

    const res = await fetch("dashboard.html");
    const html = await res.text();
    adminSection.innerHTML = html;

    // Eliminar app.js anterior si existe
    const oldScript = document.querySelector("script[data-appjs]");
    if (oldScript) oldScript.remove();

    // Crear script nuevo
    const script = document.createElement("script");
    script.src = "app.js";
    script.setAttribute("data-appjs", "true");

    script.onload = function () {
      if (typeof initPricingApp === "function") {
        initPricingApp();
      }
    };

    document.body.appendChild(script);

  } else {
    adminSection.innerHTML = `<h2>${section}</h2><p>Secci√≥n en construcci√≥n.</p>`;
  }
}

  function toggleMenu() {
    sidebar.classList.toggle("active");
    content.classList.toggle("shift");
  }

  function closeMenu() {
    sidebar.classList.remove("active");
    content.classList.remove("shift");
  }

  // Bot√≥n hamburguesa abre y cierra
  menuBtn.onclick = (e) => {
    e.stopPropagation();
    toggleMenu();
  };

  // Cerrar si haces click fuera del men√∫
  document.addEventListener("click", (e) => {
    if (
      sidebar.classList.contains("active") &&
      !sidebar.contains(e.target) &&
      e.target !== menuBtn
    ) {
      closeMenu();
    }
  });

  // Cerrar al hacer click en una opci√≥n
  document.querySelectorAll(".sidebar li").forEach(item => {
  item.addEventListener("click", () => {

    if (item.id === "logoutBtn") return;

    const section = item.dataset.section;
    if (section) {
      loadSection(section);
    }

    closeMenu();
  });
});

  // Logout
  document.getElementById("logoutBtn").onclick = () => {
    localStorage.clear();
    window.location.href = "login.html";
  };
  
  // Cargar Dashboard por defecto al entrar
loadSection("dashboard");
</script>


</body>
</html>